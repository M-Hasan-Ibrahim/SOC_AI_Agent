{
  "Brute Force": {
    "description": "Workflow for handling repeated failed login or brute force alerts on SSH/RDP services.",
    "steps": [
      {
        "step_number": 1,
        "name": "Review Alert Details",
        "action_type": "review",
        "inputs": ["alert data"],
        "outputs": ["summary of attempted logins"],
        "instructions": "Summarize which accounts and IPs are involved in the brute force attempts. Note targeted service (SSH or RDP) and destination hosts."
      },
      {
        "step_number": 2,
        "name": "Check for Threat Intelligence",
        "action_type": "enrich",
        "inputs": ["source IP"],
        "outputs": ["threat reputation of IP"],
        "instructions": "Look up the source IP in threat intelligence databases (e.g., VirusTotal, AbuseIPDB) and document if the IP is suspicious or malicious."
      },
      {
        "step_number": 3,
        "name": "Analyze Log Traffic",
        "action_type": "investigate",
        "inputs": ["network logs", "source IP", "destination port"],
        "outputs": ["list of events for attempted access"],
        "instructions": "Search for the attacker IP in logs for connections to SSH (22) or RDP (3389) ports. Document number of attempts, affected hosts, and ports."
      },
      {
        "step_number": 4,
        "name": "Determine Attack Scope",
        "action_type": "investigate",
        "inputs": ["event list"],
        "outputs": ["scope of attack"],
        "instructions": "Review destination IP addresses to see if the attacker targeted one host or multiple. Record findings."
      },
      {
        "step_number": 5,
        "name": "Check Authentication Logs",
        "action_type": "investigate",
        "inputs": ["auth logs", "source IP", "destination host"],
        "outputs": ["success/failure sequence"],
        "instructions": "Review authentication logs. For Windows, check Event IDs 4624 (success) and 4625 (failure). For Linux, grep 'Failed password' and 'Accepted password' in auth.log. Determine if a successful login follows a series of failures from the same IP."
      },
      {
        "step_number": 6,
        "name": "Search for Post-Compromise Actions",
        "action_type": "investigate",
        "inputs": ["system logs", "compromised user", "source IP"],
        "outputs": ["evidence of attacker commands"],
        "instructions": "Look for command execution events. On Windows, search for Event ID 4688 from the compromised account and attacker IP. On Linux, review bash history or audit logs. Record suspicious commands."
      },
      {
        "step_number": 7,
        "name": "Contain Affected System",
        "action_type": "contain",
        "inputs": ["compromised system"],
        "outputs": ["system isolated"],
        "instructions": "Isolate the affected system from the network to prevent further attacker activity if compromise is confirmed."
      },
      {
        "step_number": 8,
        "name": "Report and Document IOCs",
        "action_type": "report",
        "inputs": ["investigation findings"],
        "outputs": ["incident report", "list of IOCs"],
        "instructions": "Compile source IPs, destination IPs, compromised accounts, attack timeline, and commands run. Share with appropriate stakeholders and teams."
      },
      {
        "step_number": 9,
        "name": "Classify and Assess",
        "action_type": "classify",
        "inputs": ["all findings"],
        "outputs": ["incident classification", "MITRE techniques", "severity"],
        "instructions": "Classify the alert as True or False Positive. Document attack type (e.g., SSH/RDP brute force), relevant MITRE ATT&CK techniques (T1110, T1059), and assign a severity (e.g., High)."
      },
      {
        "step_number": 10,
        "name": "Recommendations and Lessons Learned",
        "action_type": "remediate",
        "inputs": ["incident report"],
        "outputs": ["remediation recommendations"],
        "instructions": "Advise on strong password policies, MFA implementation, limiting public network access, and additional monitoring. Document lessons learned and update playbook if needed."
      }
    ]
  },
  "SQL Injection": {
    "description": "Workflow for investigating suspicious URLs that may indicate SQL injection attempts.",
    "steps": [
      {
        "step_number": 1,
        "name": "Check Source IP Address",
        "action_type": "enrich",
        "inputs": ["source IP"],
        "outputs": ["IP classification", "threat reputation"],
        "instructions": "Determine if the source IP is internal or external. Check its reputation using VirusTotal and AbuseIPDB."
      },
      {
        "step_number": 2,
        "name": "Decode Suspicious URL",
        "action_type": "investigate",
        "inputs": ["alerted URL"],
        "outputs": ["decoded payload"],
        "instructions": "Decode the suspicious URL to check if it contains SQL injection payloads."
      },
      {
        "step_number": 3,
        "name": "Review Source IP Activity",
        "action_type": "investigate",
        "inputs": ["web logs", "source IP"],
        "outputs": ["list of accessed resources"],
        "instructions": "Search web logs for other requests made by the same source IP. Document all URLs accessed."
      },
      {
        "step_number": 4,
        "name": "Decode Additional Requests",
        "action_type": "investigate",
        "inputs": ["list of URLs"],
        "outputs": ["decoded payloads"],
        "instructions": "Decode all similar requests from the same source IP to check for repeated SQL injection attempts."
      },
      {
        "step_number": 5,
        "name": "Check HTTP Responses",
        "action_type": "investigate",
        "inputs": ["HTTP response logs"],
        "outputs": ["success/failure indicators"],
        "instructions": "Review HTTP responses to determine if any of the requests were accepted or returned data, indicating a possible successful injection."
      },
      {
        "step_number": 6,
        "name": "Determine Scope of Injection Attempts",
        "action_type": "investigate",
        "inputs": ["web logs", "source IP"],
        "outputs": ["list of targeted hosts"],
        "instructions": "Check if the attacker IP tried SQL injection on multiple endpoints or hosts."
      },
      {
        "step_number": 7,
        "name": "Contain Affected System",
        "action_type": "contain",
        "inputs": ["compromised system or vulnerable app"],
        "outputs": ["system isolated"],
        "instructions": "Isolate the affected application or system if compromise is suspected or confirmed."
      },
      {
        "step_number": 8,
        "name": "Report and Document IOCs",
        "action_type": "report",
        "inputs": ["investigation findings"],
        "outputs": ["incident report", "list of IOCs"],
        "instructions": "Document source IPs, targeted URLs, decoded payloads, success indicators, and attack timeline. Share report and IOCs with stakeholders."
      },
      {
        "step_number": 9,
        "name": "Classify and Assess",
        "action_type": "classify",
        "inputs": ["all findings"],
        "outputs": ["incident classification", "MITRE techniques", "severity"],
        "instructions": "Classify the alert as True or False Positive. Document attack type (e.g., SQLi), relevant MITRE ATT&CK techniques (e.g., T1190), and assign a severity."
      },
      {
        "step_number": 10,
        "name": "Recommendations and Lessons Learned",
        "action_type": "remediate",
        "inputs": ["incident report"],
        "outputs": ["remediation recommendations"],
        "instructions": "Recommend input validation, WAF deployment, and parameterized queries. Document lessons learned and update detection and prevention controls."
      }
    ]
  },
  "Suspicious URL": {
    "description": "Workflow for investigating alerts related to suspicious URLs, potentially linked to phishing, malware, or C2 activity.",
    "steps": [
      {
        "step_number": 1,
        "name": "Check Destination IP",
        "action_type": "enrich",
        "inputs": ["destination IP"],
        "outputs": ["IP classification", "threat reputation"],
        "instructions": "Determine if the destination IP is internal or external. Check the IP against threat intelligence sources (e.g., VirusTotal, AbuseIPDB)."
      },
      {
        "step_number": 2,
        "name": "Check URL Reputation",
        "action_type": "enrich",
        "inputs": ["suspicious URL"],
        "outputs": ["URL reputation"],
        "instructions": "Submit the suspicious URL to VirusTotal or similar platforms to check for known malicious content."
      },
      {
        "step_number": 3,
        "name": "Manual Analysis Suggestion",
        "action_type": "note",
        "inputs": ["suspicious URL"],
        "outputs": ["manual analysis flag"],
        "instructions": "Recommend opening the URL in AnyRun or a sandbox for further manual analysis. This step is meant for a human analyst and should not be automated."
      },
      {
        "step_number": 4,
        "name": "Contain Affected System",
        "action_type": "contain",
        "inputs": ["compromised system (if identified)"],
        "outputs": ["system isolated"],
        "instructions": "If the suspicious URL led to system compromise or malware download, isolate the affected system from the network."
      },
      {
        "step_number": 5,
        "name": "Report and Document IOCs",
        "action_type": "report",
        "inputs": ["investigation findings"],
        "outputs": ["incident report", "list of IOCs"],
        "instructions": "Document destination IPs, URLs, payloads, and timeline. Record IOCs and share with stakeholders or threat intel teams."
      },
      {
        "step_number": 6,
        "name": "Classify and Assess",
        "action_type": "classify",
        "inputs": ["all findings"],
        "outputs": ["incident classification", "MITRE techniques", "severity"],
        "instructions": "Classify the alert as True or False Positive. Document attack type (e.g., phishing, malware delivery), map to MITRE ATT&CK (e.g., T1566, T1204), and assign severity."
      },
      {
        "step_number": 7,
        "name": "Recommendations and Lessons Learned",
        "action_type": "remediate",
        "inputs": ["incident report"],
        "outputs": ["remediation recommendations"],
        "instructions": "Recommend web filtering, email scanning, user awareness training, and WAF updates. Document any process improvements and update detection logic."
      }
    ]
  }
}
